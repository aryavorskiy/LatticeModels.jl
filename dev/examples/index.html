<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · LatticeModels.jl</title><meta name="title" content="Examples · LatticeModels.jl"/><meta property="og:title" content="Examples · LatticeModels.jl"/><meta property="twitter:title" content="Examples · LatticeModels.jl"/><meta name="description" content="Documentation for LatticeModels.jl."/><meta property="og:description" content="Documentation for LatticeModels.jl."/><meta property="twitter:description" content="Documentation for LatticeModels.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="LatticeModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">LatticeModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Lowest-states-in-a-tight-binding-model"><span>Lowest states in a tight-binding model</span></a></li><li><a class="tocitem" href="#Currents-on-a-ring-shaped-sample"><span>Currents on a ring-shaped sample</span></a></li><li><a class="tocitem" href="#Time-sequences"><span>Time sequences</span></a></li><li><a class="tocitem" href="#Hofstadter-butterfly"><span>Hofstadter butterfly</span></a></li><li><a class="tocitem" href="#LDOS-animation"><span>LDOS animation</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../manual/lattice/">Defining the lattice</a></li><li><a class="tocitem" href="../manual/bonds/">Adding bonds</a></li><li><a class="tocitem" href="../manual/latticevalue/">Working with &#39;LatticeValue&#39;s</a></li><li><a class="tocitem" href="../manual/hamiltonian/">Constructing the Hamiltonian</a></li><li><a class="tocitem" href="../manual/operators/">Operators</a></li><li><a class="tocitem" href="../manual/greenfunction/">Green&#39;s function</a></li><li><a class="tocitem" href="../manual/currents/">Currents</a></li><li><a class="tocitem" href="../manual/evolution/">Unitary evolution</a></li></ul></li><li><a class="tocitem" href="../internals/">Internals</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/aryavorskiy/LatticeModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/aryavorskiy/LatticeModels.jl/blob/master/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h1><h2 id="Lowest-states-in-a-tight-binding-model"><a class="docs-heading-anchor" href="#Lowest-states-in-a-tight-binding-model">Lowest states in a tight-binding model</a><a id="Lowest-states-in-a-tight-binding-model-1"></a><a class="docs-heading-anchor-permalink" href="#Lowest-states-in-a-tight-binding-model" title="Permalink"></a></h2><p>The tight-binding model Hamiltonian is defined by this formula (the sum is performed over adjacent sites):</p><p class="math-container">\[\hat{H} = \sum_{&lt;i, j&gt;}^\text{sites} \left( c^\dagger_i c_j + h. c. \right)\]</p><p>Here we take a square lattice and build a Hamiltonian for it. Then we find its eigenstates and plot their local density on heatmaps.</p><pre><code class="language-julia hljs">using LatticeModels
using Plots
# Generate a 40x40 square lattice
l = SquareLattice(40, 40)
# Define the tight-binding model Hamiltonian
H = tightbinding_hamiltonian(l)

# Calculate eigenvalues and eigenvectors
diag = diagonalize(H)

n = 5
clims = (0, 0.0045)
p = plot(layout = @layout[grid(n, n) a{0.1w}], size=(1000, 850))
for i in 1:n^2
    E_rounded = round(diag.values[i], sigdigits=4)
    plot!(p[i], localdensity(diag[i]), title=&quot;\$E_{$i} = $E_rounded\$&quot;, st=:shape,
        clims=clims, c=:inferno, cbar=:none, lw=0, framestyle=:none, xlab=&quot;&quot;, ylab=&quot;&quot;)
end

# The following lines are kinda hacky; they draw one colorbar for all heatmaps
plot!(p[n^2+1], framestyle=:none)
scatter!([NaN], zcolor=[NaN], clims=clims, leg=:none, cbar=:right, subplot=n^2+2,
    background_subplot=:transparent, framestyle=:none, inset=bbox(0.0, 0.05, 0.95, 0.9))
savefig(&quot;local_density.png&quot;)</code></pre><p><img src="../local_density.png" alt/></p><h2 id="Currents-on-a-ring-shaped-sample"><a class="docs-heading-anchor" href="#Currents-on-a-ring-shaped-sample">Currents on a ring-shaped sample</a><a id="Currents-on-a-ring-shaped-sample-1"></a><a class="docs-heading-anchor-permalink" href="#Currents-on-a-ring-shaped-sample" title="Permalink"></a></h2><p>In this example we create a ring-shaped sample of a triangular lattice. Then we adiabatically turn on magnetic field through the hole and see currents emerge.</p><pre><code class="language-julia hljs">using LatticeModels
using Plots

l = TriangularLattice(Circle(10), !Circle(5))
removedangling!(l)
h(B) = tightbinding_hamiltonian(l, field=PointFlux(B))
diag = diagonalize(h(0))

# Find density matrix for filled bands (e. g. energy &lt; 0)
P_0 = densitymatrix(diag, mu = 0)
# Perform unitary evolution
τ = 10
a = Animation()
ev = Evolution(t -&gt; h(0.1 * min(t, τ) / τ), P_0)
for state in ev(0:0.1:2τ)
    P, H, t = state
    # Find the density and plot it
    p = plot(layout=2, size=(1000, 500))
    plot!(p[1], localdensity(P), clims=(0, 1), st=:shape)

    # Show currents on the plot
    plot!(p[2], DensityCurrents(H, P), clims=(0, 0.005), lw=1, arrowheadsize=0.3)

    title!(&quot;t = $t&quot;)
    frame(a)
end

gif(a, &quot;adiabatic_flux.gif&quot;)</code></pre><img src="51f1e1ae.gif" alt="Example block output"/><h2 id="Time-sequences"><a class="docs-heading-anchor" href="#Time-sequences">Time sequences</a><a id="Time-sequences-1"></a><a class="docs-heading-anchor-permalink" href="#Time-sequences" title="Permalink"></a></h2><p>In this example we will see how to use <code>TimeSequence</code> to store and manipulate time-dependent data.</p><p>We will calculate the evolution of a ground state of a tight-binding model after a magnetic field is turned on. We will store the local density at each time step and use it to plot the local density depending on time, as well as its time derivative and integral over time.</p><pre><code class="language-julia hljs">using LatticeModels, Plots

l = SquareLattice(20, 20)
H = tightbinding_hamiltonian(l)
psi_0 = groundstate(H)
H1 = tightbinding_hamiltonian(l, field=LandauGauge(0.1))
ev = Evolution(H1, psi_0)

densities = TimeSequence{LatticeValue}()
for (psi, _, t) in ev(0:0.1:10)
    densities[t] = localdensity(psi)
end

site_bulk = l[!, x = 10, y = 10]
site_edge = l[!, x = 10, y = 1]
ds_bulk = densities[site_bulk]
ds_edge = densities[site_edge]
plot(ds_bulk, label=&quot;ρ(t) (bulk)&quot;)
plot!(differentiate(ds_bulk), label=&quot;dρ(t)/dt (bulk)&quot;)
plot!(ds_edge, label=&quot;ρ(t) (edge)&quot;)
plot!(integrate(ds_edge), label=&quot;∫ρ(t)dt (edge)&quot;)</code></pre><img src="57ce8532.svg" alt="Example block output"/><h2 id="Hofstadter-butterfly"><a class="docs-heading-anchor" href="#Hofstadter-butterfly">Hofstadter butterfly</a><a id="Hofstadter-butterfly-1"></a><a class="docs-heading-anchor-permalink" href="#Hofstadter-butterfly" title="Permalink"></a></h2><p>The Hofstadter butterfly is a fractal-like structure that appears when the tight-binding model is subjected to a magnetic field. It is a plot of the energy spectrum as a function of the magnetic flux through the unit cell.</p><p>To create the Hofstadter butterfly, we will use the Landau gauge for the magnetic field. Note that we have to set periodic boundary conditions, and to make them compatible with the gauge field, they should be tweaked a little:</p><p class="math-container">\[\psi(x + L_x, y) = \psi(x, y) e^{2\pi i B y L_x},
\psi(x, y + L_y) = \psi(x, y)\]</p><p>Let us plot the Hofstadter butterfiles for square, triangular and honeycomb lattices. The magnetic field field will be changed from zero to one <span>$\phi_0$</span> flux quantum per plaquette.</p><pre><code class="language-julia hljs">using LatticeModels, Plots

function get_butterfly(l, lx, ly, plaquette_area)
    xs = Float64[]
    ys = Float64[]
    area = lx * ly
    dflux = 1 / area
    totflux = 1 / plaquette_area
    for B in 0:dflux:totflux
        # magnetic boundary conditions
        f(site) = exp(2pi * im * B * site.y * lx)
        lb = setboundaries(l, [lx, 0] =&gt; f, [0, ly] =&gt; true)
        H = tightbinding_hamiltonian(lb, field=LandauGauge(B))
        dg = diagonalize(H)
        append!(xs, fill(B, length(dg.values)))
        append!(ys, dg.values)
    end
    return xs, ys
end

p = plot(layout = @layout[a b; _ c{0.5w} _], size=(800, 500), leg=false,
    xlabel=&quot;B&quot;, ylabel=&quot;E&quot;)
scatter!(p[1], title=&quot;Square lattice&quot;,
    get_butterfly(SquareLattice(10, 10), 10, 10, 1), ms=1)
scatter!(p[2], title=&quot;Triangluar lattice&quot;,
    get_butterfly(TriangularLattice(10, 10), 10, 5 * sqrt(3), sqrt(3) / 4), ms=1)
scatter!(p[3], title=&quot;Honeycomb lattice&quot;,
    get_butterfly(HoneycombLattice(10, 10), 10, 5 * sqrt(3), sqrt(3) / 2), ms=1)
savefig(&quot;hofstadter_butterfly.png&quot;)</code></pre><p><img src="../hofstadter_butterfly.png" alt/></p><h2 id="LDOS-animation"><a class="docs-heading-anchor" href="#LDOS-animation">LDOS animation</a><a id="LDOS-animation-1"></a><a class="docs-heading-anchor-permalink" href="#LDOS-animation" title="Permalink"></a></h2><p>Local density can be a bit ambiguous for degenerate eigenstates. That&#39;s where the LDOS (e. g. the Local Density of States) will be helpful.</p><p>The formula for the LDOS is the following:</p><p class="math-container">\[\text{LDOS}_\alpha(E) = \text{Im} G_{\alpha\alpha}(E - i\delta)\]</p><p>where <span>$G$</span> is the Green&#39;s function and <span>$\delta$</span> is the broadening.</p><p>Let&#39;s create an animation presenting the DOS and LDOS for a square lattice with a hole indside. We will use the QWZ model hamiltonian, because it has a two-zone band structure, which will make the results more interesting. See <a href="../library/#LatticeModels.qwz-Tuple{LatticeValue}"><code>qwz</code></a> for more information about the QWZ model.</p><pre><code class="language-julia hljs">using LatticeModels
using Plots
l = SquareLattice(20, 20)
l_center = l[j1 = 8..13, j2 = 8..13]
setdiff!(l, l_center)   # remove the center
H = qwz(l)

dg = diagonalize(H)
δ = 0.1
Es = -4:0.1:4
Es_d = -4:0.01:4
G = greenfunction(dg)
a = @animate for E in Es
    p = plot(layout=2, size=(800, 400))
    plot!(p[1], Es_d, dos(G, broaden=δ), lab=&quot;&quot;, title=&quot;DOS&quot;)
    vline!(p[1], [E], lab=&quot;&quot;)
    plot!(p[2], ldos(G, E, broaden=δ), st=:shape,
        c=:inferno, clims=(0, NaN), title=&quot;LDOS&quot;, lw=0)
    plot!(p, plot_title=&quot;E = $E, δ = $δ&quot;)
end

gif(a, &quot;ldos_animation.gif&quot;, fps=10)</code></pre><img src="f0300ba8.gif" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../manual/lattice/">Defining the lattice »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Sunday 24 March 2024 01:20">Sunday 24 March 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
